[[security-update-module]]

=== Egy modul frissítése

[role="summary"]
Hogyan frissítsünk egy közösségi modult és futtassuk az adatbázis-karbantartó szkriptet adminfelületről vagy Drush-sal.

(((Közösségi modul,frissítése)))
(((Drush eszköz,modul frissítése a használatával)))
(((Modul,frissítése)))
(((Biztonsági frissítés,alkalmazása)))

==== Célkitűzés

Frissítjük webhelyünk egyik közösségi modulját az elavult verziójáról a legújabbra, majd lefuttatjuk az adatbázis-karbantartó szkriptet.

==== Szükséges előismeretek

* <<security-concept>>
* <<security-cron-concept>>

==== Webhely előfeltételei

* Legalább egy közösségi modulnak telepítve kell lennie és ahhoz elérhető frissítésnek kell lennie. Előbbihez lásd a <<extend-module-install>> leírást, míg utóbbihoz a <<security-announce>> lehet hasznos.

* Ha webhelyünk már éles, látogatók előtt megnyitott, akkor ezt a folyamatot javasolt előbb egy tesztkörnyezeten elvégezni. Erről a <<install-dev-making>> részben volt szó.

* A webhelyről készítsünk egy tartalék másolatot (lásd: <<prevent-backups>>).

* Ha az adminfelületen keresztül szeretnénk elvégezni ezt a műveletet, akkor az alaprendszer _Update Manager_ moduljának engedélyezve kell lennie. Ennek mikéntjéről a <<config-install>> szakaszban már esett szó.

* Ha viszont úgy döntünk, hogy inkább a Drush-t használnánk, akkor annak már telepítve kell lennie, melyhez további tudnivalót a <<install-tools>> szakaszban találunk.

==== Lépések

Mielőtt elkezdjük, körültekintően olvassuk el a modulhoz adott frissítési útmutatót, amit általában a projektoldalukon, a _Read Documentation_ (azaz „Dokumentáció elolvasása”) hivatkozáson találunk. Ez kifejezetten akkor szükséges, amikor valamilyen külső függvénykönyvtárat vagy harmadik fél általi szolgáltatást integráló modulról van szó. További tudnivalókat szerezhetünk még, ha letöltjük a számítógépünkre és kicsomagoljuk _tar.gz_ vagy _zip_ fájljukat és megnyitjuk bennük a _README.txt_, _INSTALL.txt_ vagy _UPGRADE.txt_ dokumentumokat. Mindezen túl pedig érdemes vetni egy pillantást a modul telepíteni tervezett verziójának kiadási jegyzékére is, amit a projektoldalán a verziószámra kattintva nyithatunk meg:

// Downloads section of the Admin Toolbar project page on drupal.org.
image:images/security-update-module-release-notes.png["Hivatkozás a kiadási jegyzékre"]

Nem meglepő módon, ahogy sok más esetben is, itt is választhatunk, hogy az adminfelületen keresztül vagy a Drush eszköz használatával szeretnénk-e elvégezni a műveletet. Ha viszont közösségi helyett egy egyedileg fejlesztett modult frissítenénk, vagy FTP-hozzáférés hiányára utaló üzenetet kapunk, esetleg az alábbi lépések nem működnének, akkor még mindig követhetjük a <<extend-manual-install>> szakasz útmutatásait. Szintén fontos figyelmeztetés, hogy néhány (manapság egyre több) közösségi modul már a Composer eszközzel kezeli a függőségeit, ezért ha erre utaló felhívást látunk a modul projektoldalán, akkor az itt leírtak helyett kövessük inkább a <<install-composer>> szakaszban leírt lépéseket. Ha azzal végeztünk, visszatérhetünk ide és folytathatjuk a 6. lépéstől tovább ugyanúgy.

===== Az adminfelület használatával

. Állítsuk a webhelyet karbantartási módba (lásd <<extend-maintenance>>).

. A _Kezelés_ adminisztrációs menüben menjünk a _Jelentések_ > _Elérhető frissítések_ > _Frissítés_ oldalra (vagy címsorban adjuk meg az _admin/reports/updates/update_ útvonalat).

. Keressük meg a felsorolásban a frissíteni kívánt modult és pipáljuk be a jelölőnégyzetet a sorában, majd kattintsunk a _Frissítések letöltése_ gombra.
+
--
// Update page for theme (admin/reports/updates/update).
image:images/security-update-module-updates.png["Elérhető frissítések",width="100%"]
--

. Kattintsunk a _Folytatás_ gombra.

. Kattintsunk az _Adatbázis-frissítések futtatása_ elemre. Ha a modul fájljait kézzel másoltuk fel, akkor innentől folytatjuk és az adatbázis-frissítés oldal megnyitásához írjuk be böngészőnk címsorába: _pelda.hu/update.php_.

. A _Folytatás_ gombra kattintva lefut a szkript, ami elvégzi valamennyi szükséges módosítást az adatbázison.

. Az _Adminisztrációs oldalak_ hivatkozásra kattintva visszajutunk az adminfelületre.

. Kapcsoljuk ki a _Karbantartási módot_ (lásd <<extend-maintenance>>).

. Ürítsük ki a gyorsítótárat (lásd <<prevent-cache-clear>>).

===== A Drush használatával

. Ehhez először is tudnunk kell a modul gépi nevét, amit legegyszerűbben a projektoldalának webcíméből találhatunk ki: a mi példánkban használt _https://www.drupal.org/project/admin_toolbar_ címből tudjuk tehát, hogy „admin_toolbar” a modul programok által használt neve.

. Futtassuk le a következő Drush parancsot. Paraméterként minden esetben meg kell adnunk a modul gépi nevét (pl. `admin_toolbar`), ha pedig több modult frissítenénk egyszerre, szóközzel elválasztva többet is megadhatunk:
+
----
$ drush up admin_toolbar
----

. Ezután már csak kövessük a képernyőn megjelenő utasításokat.

==== Az ismeretek elmélyítése

* Mint minden komolyabb beavatkozás után, modulfrissítést követően is javasolt megnézni a rendszernaplót (<<prevent-log>>) esetleges rejtett hibák felfedezése érdekében.

* <<security-update-theme>>

//==== Kapcsolódó témák

==== Videó

// Video from Drupalize.Me.
video::https://www.youtube-nocookie.com/embed/ZYFJ_OJaK4M[title="Egy modul frissítése"]

==== Egyéb források

https://www.drupal.org/node/250790[Updating modules] (azaz „Modulok frissítése”) című közösségi dokumentáció a Drupal.org-on angol nyelven.

*Közreműködők*

E témakör szövegét https://www.drupal.org/u/batigolix[Boris Doesborgh] és https://www.drupal.org/u/hey_germano[Sarah German] (https://www.advomatic.com[Advomatic]) a Drupal közösségi https://www.drupal.org/documentation[dokumentációjának] https://www.drupal.org/node/250790[Updating modules] (azaz „Modulok frissítése”) című szócikkéből vették át és szerkesztették, melynek szerzői joga 2000-2017 között azok egyéni közreműködőié. Fordította: https://www.drupal.org/u/balu-ertl[Balu Ertl] (https://www.drupal.org/brainsum[Brainsum]).
