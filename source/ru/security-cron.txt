[[security-cron]]

=== Настройка задач крона для обслуживания сайта

[role="summary"]
Как запускать задачи крона, используя модуль ядра Automated Cron или запуская крон снаружи сайта.

(((Automated Cron модуль,настройка)))
(((Задача крона,настройка)))

==== Цель

Проверить является ли задачи крона регулярными или нет,
устанавливать модуль ядра Automated Cron или запускать задачи крона
снаружи сайта.

==== Необходимые знания

<<security-cron-concept>>

// ==== Site prerequisites

==== Шаги

. Посмотреть страницу _Отчет о состоянии_ (смотрите <<prevent-status>>), где написано когда крон
запускался последний раз.
+
Если вы установили сайт используя Стандартный инсталляционный профиль (или
подобный), тогда крон уже будет запускаться через
модуль ядра Automated Cron. По умолчанию крон будет запускаться каждые три
часа.

. Выбрать стоит ли запускать крон используя модуль ядра Automated Cron
или использовать другой путь. Модуль ядра Automated Cron может не подойти
для сайтов когда:
+
  * Каждый раз кто-то заходит на страницу сайта, модуль проверяет как долго
  не запускался крон, и тогда запускает крон если это
  необходимо. Если никто не заходит на сайт долгое время, то крон
  не будет запускаться.
  * Крон запускается после того как страница сгенерирована. Это означает,
  что останется меньше времени для выполнения крона перед тем как различные лимиты времени на сервере
  будут превышены (например, время исполнения PHP скрипта). Если это случается, то в логах (смотрите
  <<prevent-log>>) будет показано сообщения об ошибках, о том что крон не мог исполниться.
  * Крон слабо поддерживает https://ru.wikipedia.org/wiki/%D0%9C%D0%B0%D1%81%D1%88%D1%82%D0%B0%D0%B1%D0%B8%D1%80%D1%83%D0%B5%D0%BC%D0%BE%D1%81%D1%82%D1%8C[Масштабируемость]
  если работает на модуле ядра Automated Cron. Это происходит потому что процесс веб
  сервера занят (и не может обслуживать другие веб страницы) пока
  крон выполняется.

. Если вы хотите использовать модуль Automated Cron, сперва убедитесь, что он
установлен (Модуль устанавливается вместе со Стандартным инсталляционным профилем; смотрите
<<config-install>> если модуль не установлен).
+
Дальше, настройте модуль, задав частоту с которой крон будет
выполняться. В меню администратора _Управление_, перейдите на _Конфигурация_ >
_Система_ > _Крон_ (_admin/config/system/cron_). Выберите желаемый интервал в поле
_Запускать cron каждые_ в разделе _Настройки крон_, и нажмите _Сохранить
конфигурацию_.
+
--
// Cron configuration page (admin/config/system/cron).
image:images/security-cron.png["Настройки модуля ядра Automated Cron"]
--

. Если вы хотите запускать крон снаружи сайта, удалите
модуль ядра Automated Cron (смотрите <<config-uninstall>>). Дальше, найдите
URL адрес крона. Этот URL показывается на странице _Отчет о состоянии_ (смотрите <<prevent-status>>) и
на странице _Крон_ (смотрите предыдущий шаг). Этот URL адрес выглядит
примерно вот так:
_http://www.example.com/cron/0MgWtfB33FYbbQ5UAC3L0LL3RC0PT3RNUBZILLA0Nf1Re_
+
Всякий раз когда URL адрес крона посещен, крон будет запускаться. Настройте один из
следующих планировщиков посещать этот адрес URL регулярно:
+
  * https://www.drupal.org/node/23714[The Cron daemon] (Linux, OS X, Solaris,
  BSD)
  * https://www.drupal.org/node/31506[Scheduled Tasks] (Windows)
  * Сервис SASS для крон (software as a service)
  * Крон менеджер предоставляемый вашим хостингом (смотрите документацию
  предоставляемую вашим хостинг провайдером)


// ==== Expand your understanding

==== Связанные концепции

<<security-concept>>

==== Видео

// Video from Drupalize.Me.
video::https://www.youtube-nocookie.com/embed/ts4g1jTEAt4[title="Configuring Cron Maintenance Tasks"]

==== Дополнительные материалы

* http://docs.drush.org/en/master/cron/[Drush page "Running Drupal cron tasks from Drush"]
* https://www.drupal.org/docs/7/setting-up-cron/overview[_Drupal.org_ community documentation page "Setting up cron"]


*Авторы*

Написано и отредактировано https://www.drupal.org/u/dalin[Dave Hansen-Lange] из
https://www.advomatic.com/[Advomatic],
https://www.drupal.org/u/batigolix[Boris Doesborg],
и https://www.drupal.org/u/jhodgdon[Jennifer Hodgdon].

Переведено https://www.drupal.org/u/levmyshkin[Абраменко Иван] из
https://www.technocrat.com.au/[Technocrat].
