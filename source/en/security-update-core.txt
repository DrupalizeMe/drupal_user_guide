[[security-update-core]]

=== Updating the Core Software

(((Core software,updating)))
(((Drush tool,using to update the core software)))
(((Administrative interface,using to update the core software)))

==== Goal

Update the core software, either through the administrative interface or by
using Drush.

//==== Prerequisite knowledge

==== Site prerequisites

* If you want to use Drush, Drush must be installed. See <<install-tools>>.

* If your site is live, you should test this process in a development
environment before running it on your production site. See
<<install-dev-making>>.

==== Steps

. Take a backup of your code as well as database. It will help you in disaster
recovery if anything goes wrong during update process. Refer to
<<prevent-backups>> to learn more about taking the complete backups of your
site.

. Open the _/sites/default/settings.php_ file in any plain text editor.  Find
the line about _$settings['update_free_access']_ variable. By default, it is set
to *FALSE* due to security reasons. Edit it so it says:
+
----
$settings['update_free_access'] = TRUE;
----

[start=3]
. Disable any caching technique (memcache, varnish, and so on) your application
might be using.

. Put your site in to <<extend-maintenance, maintenance mode>>.

. Download Drupal 8.x core latest version (preferably, stable version) manually
from https://www.drupal.org/project/drupal[_Drupal.org_ Drupal Core Downloads] and
extract it to some backup or temporary directory on your server (should be
outside the directory where the site is hosted). You may use Drush command
instead, in order to achieve the same by navigating to the backup or temporary
directory on the server and enter this command on your Drush command prompt:
+
----
drush dl drupal
----

[start=6]
. Delete the _core_ directory, and all the independent files, including
_.htaccess_, _composer.json_,_autoload.php_, and so on from your installation
directory. In case, you had included any custom file or customized any of
these files, it is *not recommended* to delete them; else you may end up
losing the custom functionalities that use these custom/customized files.

. Copy the _core_ directory and the non-custom/non-customized files that you may
have deleted during the preceding step from the newly downloaded code base (in
our case, _drupal-8.0.0-beta14_) and paste them to your site
directory (version _8.0.0-beta13_).

. Run the _update.php_ script using either of the following, and let the script
do its job:
+
*Using Browser interface:*
+
_http://www.example.com/update.php_
+
*Using Drush command:*
+
----
drush updb //where, updb is the alias of pm-updatedb
----

[start=9]
. In case you get to see any error or warning, you are advised to re-run the
_update.php_ script again until all the updates have been completed
successfully.

. Either navigate to _Configuration > Development > Performance_ and clear the
cache using the administer interface; or run the following Drush command:
+
----
drush cc all //where cc is the alias of clear-cache
----

[start=11]
. Open the _/sites/default/settings.php_ file in a text editor. Find the line
about _$settings['update_free_access']_ and edit it so it says:
+
----
$settings['update_free_access'] = FALSE;
----

[start=12]
. Put your site out of the <<extend-maintenance, maintenance mode>>.

. In case you are using any caching technique (varnish, memcache, or so on) and
had disabled at *step 3*, re-enable them; else, skip this step.

. By now, you should be able to have the updated version running. To cross
verify the current version of your software, navigate to _Reports > Status
report_. Following screen shot demonstrates the status report with the desired
output encircled:
+
// Login to your Drupal 8 site as an administrator and navigate to _Reports >
// Status report_ page. Add a circle around the Drupal version.
image:images/security-update-core_statusReport.png["Status report",width="100%"]

*Note:* When you have cleared the cache, you might come across error(s) asking
you to rebuild your registry. This is sometimes essential if a module has moved
around during the update process. To get rid of such error messages, follow the
instructions on the
https://www.drupal.org/project/registry_rebuild[_Drupal.org_ page "Registry Rebuild"].

To learn more about updating the core software, refer to _/core/UPGRADE.txt_
within your installation.

==== Follow-on tasks

* <<install-tools>>
* <<install-dev-making>>
* <<prevent-backups>>

==== Related concepts

<<prevent-status>>

==== Additional resources

* https://www.drupal.org/project/drupal["Drupal Core Downloads" page on _Drupal.org_]
* https://www.drupal.org/project/registry_rebuild["Registry Rebuild" page on _Drupal.org_]
