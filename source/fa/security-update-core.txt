[[security-update-core]]
=== بروزرسانی دروپال

[role="summary"]
چگونگی بروزرسانی دروپال با استفاده از رابط مدیریتی یا Drush.

(((Core software,updating)))
(((Drush tool,using to update the core software)))
(((Administrative interface,using to update the core software)))

==== هدف

بروزرسانی دروپال با استفاده از رابط مدیریتی یا Drush.


//==== Prerequisite knowledge

==== پیشنیازهای سایت

* اگر قصد استفاده از Drush را دارید، <<install-tools>> را مشاهده کنید.

* اگر سایت شما در دسترس عموم قرار دارد، ابتدا باید این فرآیند را در یک سایت توسعه آزمایش سپس به سایت اصلی منتقل کنید. <<install-dev-making>> را مشاهده کنید.

==== گام‌ها

. یک پشتیبان کامل از سایت خود بگیرید. به <<prevent-backups>> مراجعه کنید.

. فایل _settings.php_ (_/sites/default/settings.php_) را در یک ویرایشگر متن ساده باز کنید. خط مربوط به متغیر _$settings['update_free_access']_ را پیدا کنید. به صورت پیشفرض مقدار "FALSE" را دارد، بنا بر دلایل امنیتی. تنظیم آن را به "TRUE" تغییر دهید:
+
----
$settings['update_free_access'] = TRUE;
----

. هر گونه تکنیک caching از جمله memcache یا varnish که نرم‌افزار از آن استفاده می‌کند را غیرفعال کنید.

. سایت را در حالت نگهداری قرار دهید. <<extend-maintenance>> را مشاهده کنید.

. اگر برای مدیریت وابستگی‌ها از Composer یا Git استفاده می‌کنید، شش گام بعدی را نادیده گرفته و در عوض <<install-composer>> را به منظور دانلود فایل‌های بروزرسانی مشاهده کنید. با گام _update.php_ ادامه دهید.

. فایل بایگانی tar.gz یا zip مربوط به آخرین نسخه از انتشار دروپال ۸ را از صفحه https://www.drupal.org/project/drupal[دانلود دروپال] دریافت کنید. به منظور چگونگی یافتن آخرین نسخه <<install-prepare>> را مشاهده کنید.

. فایل بایگانی را در سرور میزبانی سایت خود آپلود کنید.

. محتویات فایل بایگانی را در یک دایرکتوری موقت از سرور قرار دهید (باید خارج از مسیر اصلی سایت باشد). مدیر فایل سرویس میزبانی شما باید روشی برای اینکار داشته باشد. اگر به ترمینال سرور (لینوکس) خود دسترسی دارید می‌توانید از دستور زیر استفاده کنید:
+
----
tar -xzf drupal-8.3.2.tar.gz
----

. همچنین می‌توانید با استفاده از Drush عملیات دانلود و استخراج فایل‌ها را با رفتن به یک دایرکتوری موقت از سرور به صورت زیر انجام دهید:
+
----
drush dl drupal
----

. در دایکتوری میزبانی سایت خود دایرکتوری‌های _core_ و _vendor_ همراه با تمام فایل‌هایی که درون یک دایرکتوری فرزند نیستند را پاک کنید از جمله _.htaccess، composer.json و autoload.php_. فایل‌های سفارشی شده را پاک نکنید چرا که ممکن است تغییرات اعمال شده در آن‌ها را از دست بدهید.

. دایرکتوری‌های _core_ و _vendor_ به همراه تمام فایل‌هایی که از گام قبلی پاک کردید را از دایرکتوری موقت به دایرکتوری سایت خود انتقال دهید.

. با یکی از روش‌های زیر اسکریپت _update.php_ را اجرا کنید:
+
  * به نشانی _http://www.example.com/update.php_ در مرورگر خود بروید (به صورتی که _www.example.com_ نشانی سایت شما است). روی _ادامه_ در اولین صفحه کلیک کنید تا عملیات بروزرسانی انجام شود.
  * دستور `drush updb` را از Drush اجرا کنید.

. اگر خطا یا هشداری دریافت کردید، اسکریپت _update.php_ را مجدد اجرا کنید تا تمام بروزرسانی‌ها اعمال شوند.

. فایل _settings.php_ (_/sites/default/settings.php_) را در یک ویرایشگر متن ساده باز کنید. خط مربوط به متغیر _$settings['update_free_access']_ را پیدا کنید. تنظیم آن را به "FALSE" تغییر دهید:
+
----
$settings['update_free_access'] = FALSE;
----

. روی _صفحات مدیریتی_ کلیک کنید تا به قسمت مدیریتی سایت خود بازگردید.

. سایت را از حالت نگهداری خارج کنید. <<extend-maintenance>> را مشاهده کنید.

. حافظه موقت را پاکسازی کنید. <<prevent-cache-clear>> را مشاهده کنید.

. هر گونه تکنیک caching که در گام ۳ غیرفعال کرده‌اید را مجدد فعال کنید.

. اکنون سایت شامل نسخه بروزرسانی شده است و می‌توانید اطلاعات مربوط به آن را از صفحه _گزارش وضعیت_ بازبینی کنید (<<prevent-status>> را مشاهده کنید).

==== درک خود را گسترش دهید

* <<install-tools>>
* <<install-dev-making>>
* <<prevent-backups>>

==== موضوعات مرتبط

<<prevent-status>>

==== منابع مطالعاتی

* https://www.drupal.org/project/drupal[صفحه "دانلود دروپال" در _Drupal.org_]
* https://www.drupal.org/project/registry_rebuild[صفحه "بازسازی رجیستری" در _Drupal.org_]
* فایل _/core/UPDATE.txt_ از نصب دروپال.


*مشارکت‌کنندگان*

نگارش و ویرایش توسط https://www.drupal.org/u/surendramohan[Surendra Mohan]، https://www.drupal.org/u/batigolix[Boris Doesborgh] و https://www.drupal.org/u/jojyja[Jojy Alphonso] در http://redcrackle.com[Red Crackle]

ترجمه توسط https://www.drupal.org/u/novid[Navid Emami]
